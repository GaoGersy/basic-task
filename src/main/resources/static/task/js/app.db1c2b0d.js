(function(t){function e(e){for(var i,l,o=e[0],r=e[1],c=e[2],d=0,h=[];d<o.length;d++)l=o[d],Object.prototype.hasOwnProperty.call(s,l)&&s[l]&&h.push(s[l][0]),s[l]=0;for(i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i]);u&&u(e);while(h.length)h.shift()();return n.push.apply(n,c||[]),a()}function a(){for(var t,e=0;e<n.length;e++){for(var a=n[e],i=!0,o=1;o<a.length;o++){var r=a[o];0!==s[r]&&(i=!1)}i&&(n.splice(e--,1),t=l(l.s=a[0]))}return t}var i={},s={app:0},n=[];function l(e){if(i[e])return i[e].exports;var a=i[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.m=t,l.c=i,l.d=function(t,e,a){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)l.d(a,i,function(e){return t[e]}.bind(null,i));return a},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="/task/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],r=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=r;n.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"0226":function(t,e,a){},"129f1":function(t,e,a){"use strict";a("e603")},"14dc":function(t,e,a){},"199c":function(t,e,a){"use strict";a("9f45")},"1aef":function(t,e,a){"use strict";a("82f0")},"1ca7":function(t,e,a){"use strict";a("6d78")},"236b":function(t,e,a){t.exports=a.p+"img/time.a4976729.svg"},2949:function(t,e,a){"use strict";a("6337")},"2f21":function(t,e,a){"use strict";a("e7ad")},"2ff1":function(t,e,a){"use strict";a("47b7")},"3ac0":function(t,e,a){"use strict";a("73f3")},"3b8b":function(t,e,a){},"42e9":function(t,e,a){"use strict";a("607a")},"477f":function(t,e,a){t.exports=a.p+"img/password.a6167d3e.svg"},"47b7":function(t,e,a){},"51f3":function(t,e,a){"use strict";a("8c1b")},"52ed":function(t,e,a){"use strict";a("c02f")},"54f4":function(t,e,a){a("d81d"),a("d3b7"),a("ddb0");var i=function(t){return t.keys().map(t)},s=a("a82a");i(s)},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var i=a("2b0e"),s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("task-schedule")],1)},n=[],l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"file-watch-wrap"},[a("div",{staticStyle:{width:"280px","border-right":"1px solid #dfe1e6"}},[a("add-comp",{on:{handleAdd:t.addFile,handleInput:t.searchFile}}),a("div",{staticStyle:{height:"calc(100% - 60px)"}},[a("scroll-group",{attrs:{enableDelete:!0},on:{change:t.handleClick,delete:t.handleDel},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.fileData,(function(e,i){return a("scroll-item",{attrs:{itemKey:e.key,index:i,source:e}},[a("task-item",{attrs:{data:e,index:i},on:{handleCopy:t.handleCopy}})],1)})),1)],1)],1),a("transition",{attrs:{name:"fade-transform",mode:"out-in"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showContent,expression:"showContent"}],staticClass:"content-view-wrap"},[a("task-content",{attrs:{loggerData:t.loggerData,form:t.currentViewData,state:t.state},on:{handleAdd:t.handleAdd,handleUpdate:t.handleUpdate}})],1)]),a("el-dialog",{attrs:{title:"删除提示",visible:t.visibleDialog,width:"30%"},on:{"update:visible":function(e){t.visibleDialog=e}}},[a("span",[t._v("确定删除该任务吗？")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.visibleDialog=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.deleteFile}},[t._v("确 定")])],1)])],1)},o=[],r=(a("a4d3"),a("e01a"),a("c975"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("recycle-scroller",{staticClass:"recycle-list-wrap",attrs:{items:t.data,"item-size":t.itemSize,"key-field":t.itemKey},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.item;return[a("item",{attrs:{source:i,itemKey:i[t.itemKey]},on:{handleClick:t.handleItemClick,handleDel:t.handleDel}},[t._t("default",null,{item:i})],2)]}}],null,!0)})}),c=[],u=(a("99af"),a("fb6a"),a("a434"),a("a9e3"),a("a899"),a("e508")),d=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box-wrap",class:[t.isActive?"active":""]},[a("div",{staticClass:"item-content",on:{click:t.handleClick,mouseover:function(e){t.showDelete=!0},mouseout:function(e){t.showDelete=!1}}},[t._t("default"),a("el-popconfirm",{attrs:{placement:"bottom",title:"确定删除该任务吗？",width:"200",trigger:"manual"},on:{onConfirm:t.handleDel,onCancel:function(e){t.visible=!1}},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("span",{directives:[{name:"show",rawName:"v-show",value:t.showDelete,expression:"showDelete"}],staticClass:" el-icon-close del",attrs:{slot:"reference"},on:{click:function(e){e.stopPropagation(),t.visible=!t.visible}},slot:"reference"})])],2)])},h=[],f={name:"recycleItem",data:function(){return{showDelete:!1,visible:!1}},props:{source:{type:Object,default:function(){return{}}},itemKey:""},inject:["scroller"],methods:{handleClick:function(){this.$emit("handleClick",this.source),this.$forceUpdate()},handleDel:function(){this.visible=!1,this.$emit("handleDel",this.source)}},computed:{isActive:function(){return this.scroller.activeKeys.indexOf(this.itemKey)>-1}}},p=f,m=(a("b12d"),a("2877")),v=Object(m["a"])(p,d,h,!1,null,"1a3d0ff8",null),g=v.exports,b={name:"RecycleView",data:function(){return{activeKeys:[].concat(this.value)}},props:{data:{require:!0,type:Array},itemSize:{default:80,type:Number},single:{type:Boolean,default:!0},inverse:{type:Boolean,default:!1},value:{type:[Array,String,Number],default:function(){return[]}},itemKey:{require:!0,default:"id"}},watch:{value:function(t){this.activeKeys=[].concat(t)}},provide:function(){return{scroller:this}},methods:{handleClick:function(t){this.$emit("handleSelect",t)},handleDel:function(t){this.$emit("handleDel",t)},setActiveNames:function(t){t=[].concat(t);this.single&&t[0];this.activeKeys=t},handleItemClick:function(t){if(this.single)this.setActiveNames((this.activeKeys[0]||0===this.activeKeys[0])&&this.activeKeys[0]===t[this.itemKey]&&this.inverse?"":t[this.itemKey]);else{var e=this.activeKeys.slice(0),a=e.indexOf(t[this.itemKey]);a>-1?e.splice(a,1):e.push(t[this.itemKey]),this.setActiveNames(e)}this.$emit("handleSelect",t)}},components:{RecycleScroller:u["c"],item:g}},y=b,C=(a("199c"),Object(m["a"])(y,r,c,!1,null,"3a720b1e",null)),w=C.exports,D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"add-wrap"},[a("el-input",{staticStyle:{width:"calc(100% - 60px)","margin-right":"10px"},attrs:{size:"small",placeholder:"请输入内容"},on:{input:t.handleInput},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"suffix"},slot:"suffix"})]),a("span",{staticClass:"delete-item",on:{click:t.handleAdd}},[a("i",{staticClass:"el-icon-circle-plus-outline add-icon"})])],1)},x=[],k=(a("ac1f"),a("841c"),{name:"AddComp",data:function(){return{search:""}},methods:{handleAdd:function(){this.$emit("handleAdd")},handleInput:function(){this.$emit("handleInput",this.search)}}}),_=k,F=(a("1aef"),a("42e9"),Object(m["a"])(_,D,x,!1,null,"176755a2",null)),S=F.exports,E=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"scroll-group-wrap"},[t._t("default")],2)},j=[],I={itemKey:"ScrollGroup",componentName:"ScrollGroup",props:{value:{type:[Array,String,Number],default:function(){return[]}},multiSelect:{type:Boolean,default:!1},enableDelete:{type:Boolean,default:!0}},data:function(){return{activeKeys:[].concat(this.value)}},watch:{value:function(t){this.activeKeys=[].concat(t)}},provide:function(){return{scroller:this}},methods:{setActiveNames:function(t){t=[].concat(t);var e=this.multiSelect?t[0]:t;this.activeKeys=t,this.$emit("input",e),this.$emit("change",e)},handleItemClick:function(t){if(this.multiSelect){var e=this.activeKeys.slice(0),a=e.indexOf(t.itemKey);a>-1?e.splice(a,1):e.push(t.itemKey),this.setActiveNames(e)}else this.setActiveNames(t.itemKey)},handleItemDelete:function(t){this.$emit("delete",t)}},created:function(){this.$on("item-click",this.handleItemClick),this.$on("item-delete",this.handleItemDelete)}},N=I,$=(a("1ca7"),Object(m["a"])(N,E,j,!1,null,"4d9df227",null)),T=$.exports,q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"scroll-item-wrap",class:[t.isActive?"active":""]},[a("div",{staticClass:"item-content",on:{click:t.handleClick,mouseover:t.handleMouseOver,mouseout:t.handleMouseOut}},[t._t("default"),a("span",{directives:[{name:"show",rawName:"v-show",value:t.isEnableDelete&&t.showDelete,expression:"isEnableDelete&&showDelete"}],staticClass:" el-icon-close del",attrs:{slot:"reference"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleDel(e)}},slot:"reference"})],2)])},A=[];a("4160"),a("159b");function O(t,e,a){this.$children.forEach((function(i){var s=i.$options.componentName;s===t?i.$emit.apply(i,[e].concat(a)):O.apply(i,[t,e].concat([a]))}))}var L={methods:{dispatch:function(t,e,a){var i=this.$parent||this.$root,s=i.$options.componentName;while(i&&(!s||s!==t))i=i.$parent,i&&(s=i.$options.componentName);i&&i.$emit.apply(i,[e].concat(a))},broadcast:function(t,e,a){O.call(this,t,e,a)}}},U={name:"ScrollItem",componentName:"ScrollItem",mixins:[L],data:function(){return{showDelete:!1,visible:!1}},props:{source:{type:Object,default:function(){return{}}},index:"",itemKey:""},inject:["scroller"],methods:{handleClick:function(){this.dispatch("ScrollGroup","item-click",this)},handleDel:function(){this.visible=!1,this.dispatch("ScrollGroup","item-delete",this.source)},handleMouseOver:function(){this.showDelete=!0},handleMouseOut:function(){this.showDelete=!1}},computed:{isActive:function(){if(this.scroller.activeKeys)return this.scroller.activeKeys.indexOf(this.itemKey)>-1},isEnableDelete:function(){return this.scroller.enableDelete}}},K=U,J=(a("6e98"),Object(m["a"])(K,q,A,!1,null,"ec51b5ea",null)),V=J.exports,B=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box-content"},[a("el-popover",{attrs:{placement:"top",width:"160",trigger:"manual"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("p",[t._v("确定新增任务？")]),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.visible=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSuccess(e)}}},[t._v("确定")])],1)]),a("div",{staticClass:"state",class:[1===t.data.jobStatusCode?"access":"forbid"],on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.visible=!0}}},[t._v(t._s(t.index+1))]),a("div",{staticClass:"value"},[a("div",{staticClass:" item"},[a("span",{staticClass:"fl title"},[t._v(t._s(t.data.alias)+"（"+t._s(t.data.jobName)+"）")]),t.data.peddingCount?a("span",{staticClass:"fr  count"},[t._v(t._s(t.data.peddingCount))]):t._e()]),a("div",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("cron表达式：")]),t._v(t._s(t.data.cronExpression))]),a("div",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("下次执行时间：")]),t._v(t._s(t._f("formDate")(t.data.nextFireTime)))]),a("div",[a("span",{staticClass:"job-button",staticStyle:{background:"#3CA272"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleJobBtn("1")}}},[t._v("立即执行")]),a("span",{directives:[{name:"show",rawName:"v-show",value:1!==t.data.jobStatusCode,expression:"data.jobStatusCode!==1"}],staticClass:"job-button",staticStyle:{background:"#91CB74"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleJobBtn("3")}}},[t._v("启动")]),a("span",{directives:[{name:"show",rawName:"v-show",value:1===t.data.jobStatusCode,expression:"data.jobStatusCode===1"}],staticClass:"job-button",staticStyle:{background:"#FC8452"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleJobBtn("4")}}},[t._v("暂停")]),a("span",{directives:[{name:"show",rawName:"v-show",value:1===t.data.status,expression:"data.status===1"}],staticClass:"job-button",staticStyle:{background:"#EE6666"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleJobBtn("2")}}},[t._v("停止")])])])],1)},P=[],z={data:function(){return{visible:!1}},props:{data:{type:Object,require:!0},index:{require:!0}},methods:{handleSuccess:function(){this.visible=!1,this.$emit("handleCopy",this.data)},message:function(t,e){this.$message({message:t||"成功了！",type:e||"success"})}}},M={name:"TaskItem",mixins:[z],data:function(){return{}},filters:{formDate:function(t){return t?new Date(t).format("MM-dd hh:mm:ss"):"--"}},methods:{handleJobBtn:function(t){switch(t){case"1":this.doJob();break;case"2":this.unDoJob();break;case"3":this.startUpPushJob();break;case"4":this.pausePushJob();break}},doJob:function(){var t=this,e="jobDetails/runJobNow";this.request.postJson(e,this.data).then((function(e){200===e.data.code&&(t.message("执行完成！","success"),t.handleUpdate(e.data.data,["status","nextFireTime","peddingCount"]))})).catch((function(e){t.message("执行失败！","error")}))},unDoJob:function(){var t=this,e="/jobDetails/interruptJob";this.request.postJson(e,this.data).then((function(e){200===e.data.code&&(t.message(e.data.message,"success"),t.handleUpdate(e.data.data,["status"]))})).catch((function(e){t.message("任务中断失败！","error")}))},startUpPushJob:function(){var t=this,e="/jobDetails/resumeJob";this.request.postJson(e,this.data).then((function(e){200===e.data.code&&(t.message(e.data.message,"success"),t.handleUpdate(e.data.data,["jobStatusCode"]))})).catch((function(e){t.message("启动失败！","error")}))},pausePushJob:function(){var t=this,e="/jobDetails/pauseJob";this.request.postJson(e,this.data).then((function(e){200===e.data.code&&(t.message(e.data.message,"success"),t.handleUpdate(e.data.data,["jobStatusCode"]))})).catch((function(e){t.message("任务中断失败！","error")}))},handleUpdate:function(t,e){for(var a=0,i=e.length;a<i;a++){var s=e[a];this.data[s]=t[s]}this.data.isUpdate=!1}}},R=M,W=(a("129f1"),Object(m["a"])(R,B,P,!1,null,"0febe1ca",null)),H=W.exports,G=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-view"},[a("div",{staticClass:"save-button"},[a("el-button",{staticStyle:{width:"100px"},attrs:{type:t.isEdit?"primary":"info",disabled:!t.isEdit,size:"small"},on:{click:t.save}},[t._v("保存 ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.state===t.handleType["scan"],expression:"state===handleType['scan']"}],staticClass:"update-remind"},[a("span",{staticClass:"job-name-title"},[t._v(t._s(t.selfForm.alias)+"("+t._s(t.selfForm.jobGroup)+")")]),a("span",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],staticClass:"remind"},[t._v("注意：内容正在编辑，修改完成记得保存哟！")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.state===t.handleType["add"],expression:"state===handleType['add']"}],staticClass:"add-remind"},[a("span",{staticClass:"add-warn"},[t._v("注意：当前正在创建一个新的文件推送任务！")])])],1),a("div",{staticClass:"content-mid-wrap"},[a("div",{staticClass:"block"},[a("div",{staticClass:"title"},[t._v("基础信息"),a("svg-icon",{staticClass:"required",attrs:{"icon-class":"require"}})],1),a("card",{attrs:{label:"文件推送基本信息"}},[a("editor-input",{staticStyle:{"margin-bottom":"15px"},attrs:{label:"名称",required:!0,disabled:t.state===t.handleType["scan"],value:t.selfForm.jobName},on:{change:t.changeEditState,"update:value":function(e){return t.$set(t.selfForm,"jobName",e)}}}),a("editor-input",{staticStyle:{"margin-bottom":"15px"},attrs:{label:"组名",required:!0,disabled:t.state===t.handleType["scan"],value:t.selfForm.jobGroup},on:{change:t.changeEditState,"update:value":function(e){return t.$set(t.selfForm,"jobGroup",e)}}}),a("editor-input",{staticStyle:{"margin-bottom":"15px"},attrs:{label:"别名",required:!0,value:t.selfForm.alias},on:{change:t.changeEditState,"update:value":function(e){return t.$set(t.selfForm,"alias",e)}}}),a("editor-input",{staticStyle:{"margin-bottom":"15px"},attrs:{label:"描述",required:!0,value:t.selfForm.description},on:{change:t.changeEditState,"update:value":function(e){return t.$set(t.selfForm,"description",e)}}}),a("div",{staticClass:"item-block"},[a("el-popover",{model:{value:t.cronPopover,callback:function(e){t.cronPopover=e},expression:"cronPopover"}},[a("cron",{on:{change:t.changeCron,close:function(e){t.cronPopover=!1}}}),a("editor-input",{staticStyle:{"margin-bottom":"15px"},attrs:{slot:"reference",label:"cron表达式",required:!0,value:t.selfForm.cronExpression},on:{change:t.changeCronValue,"update:value":function(e){return t.$set(t.selfForm,"cronExpression",e)}},slot:"reference"})],1)],1)],1)],1),a("div",{staticClass:"block"},[a("div",{staticClass:"title"},[t._v("任务设置")]),a("card",{attrs:{label:"任务配置"}},[a("div",[a("span",{staticClass:"labelName"},[a("svg-icon",{staticClass:"required",attrs:{"icon-class":"require"}}),t._v("任务类型：")],1),a("el-select",{attrs:{multiple:"","collapse-tags":"",placeholder:"请选择"},on:{change:t.changeEditState},model:{value:t.currentJob,callback:function(e){t.currentJob=e},expression:"currentJob"}},t._l(t.AllJob,(function(e){return a("el-option-group",{key:e.value,attrs:{label:e.label}},t._l(e.options,(function(t,e){return a("el-option",{key:t.taskName+t.group,attrs:{label:t.taskName,value:t.taskName+t.group}})})),1)})),1)],1),t.taskInfos&&t.taskInfos.length>0?a("tab",{staticStyle:{"margin-top":"10px"},attrs:{"tab-data":t.taskInfos},on:{change:t.changeTab}}):t._e()],1)],1),a("div",{staticClass:"block"},[a("div",{staticClass:"title"},[t._v("任务日志")]),a("card",{staticStyle:{padding:"0"},attrs:{label:"任务日志"}},[a("task-logger",{attrs:{jobKey:t.form.key,loggerData:t.loggerData}})],1)],1)])])},Y=[],Q=(a("4de4"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card-wrap"},[a("div",{staticClass:"label"},[t._v(t._s(t.label))]),a("div",{staticClass:"content"},[t._t("default")],2)])}),X=[],Z={name:"Card",data:function(){return{}},props:{label:{type:String,default:"标签"}}},tt=Z,et=(a("c6fa"),Object(m["a"])(tt,Q,X,!1,null,"2d13f82c",null)),at=et.exports,it=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"editor-input-wrap"},[a("span",{ref:"label",attrs:{id:"label"}},[t._v(" "+t._s(t.label)+" ：")]),a("el-input",{style:t.inputWidth,attrs:{disabled:t.disabled,type:"text",size:"small"},on:{input:t.change},model:{value:t.selfValue,callback:function(e){t.selfValue=e},expression:"selfValue"}})],1)},st=[],nt=(a("b64b"),a("466d"),a("53ca"));function lt(t){if(!t&&"object"!==Object(nt["a"])(t))throw new Error("error arguments","shallowClone");var e=t.constructor===Array?[]:{};return Object.keys(t).forEach((function(a){var i=t[a];i&&"object"===Object(nt["a"])(i)?i instanceof Date?e[a]=new Date(i.getTime()):e[a]=lt(i):e[a]=i})),e}var ot,rt,ct=function(t){for(var e=0,a=0;a<t.length;a++){var i=t.charAt(a);null!=i.match(/[^\x00-\xff]/gi)?e+=2:e+=1}return e},ut={name:"EditorInput",props:{value:null,label:null,required:{type:Boolean,default:!1},disabled:!1},data:function(){return{edit:!1}},mounted:function(){},methods:{change:function(){this.edit=!1,this.$emit("change",this.target)},setInputSize:function(){this.size=10*this.selfValue.length+40}},watch:{},computed:{inputWidth:function(){var t=9*ct(this.label)+10+"px";return{width:"calc(100% - ".concat(t,")")}},selfValue:{get:function(){return this.value},set:function(t){this.$emit("update:value",t)}},size:{get:function(){return this.value?10*this.value.length+40:60},set:function(t){}}}},dt=ut,ht=(a("6cd4"),a("2949"),Object(m["a"])(dt,it,st,!1,null,"75deb0ab",null)),ft=ht.exports,pt={data:function(){return{isEdit:!1}},props:{form:{type:Object,require:!0},state:0},methods:{save:function(){var t,e=this;this.validate()?this.message("信息不能留空，请继续填写！","warning"):(this.setRequestData(),t=this.state===this.handleType["add"]||this.state===this.handleType["copy"]?this.addUrl:this.updateUrl,this.request.postJson(t,this.selfForm).then((function(t){200===t.data.code&&(e.message("保存成功！"),e.state===e.handleType["add"]||e.state===e.handleType["copy"]?e.$emit("handleAdd",t.data.data):e.$emit("handleUpdate",t.data.data),e.isEdit=!1)})).catch((function(t){e.isEdit=!1,e.message("保存失败！","error")})))},setRequestData:function(){},message:function(t,e){this.$message({message:t||"成功了！",type:e||"success"})},changeEditState:function(){this.isEdit=!0}},components:{Card:at,EditorInput:ft}},mt={scan:0,add:1,copy:2},vt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tab-wrap"},[a("div",{staticClass:"tab-nav"},[a("draggable",t._b({model:{value:t.tabDataSelf,callback:function(e){t.tabDataSelf=e},expression:"tabDataSelf"}},"draggable",t.dragOptions,!1),[a("transition-group",{attrs:{type:"transition"}},t._l(t.tabDataSelf,(function(e){return a("div",{key:e.className,staticClass:"tab-item",class:[t.currentType===e.taskName?"active":""],on:{click:function(a){return t.handleTab(e)}}},[t._v(" "+t._s(e.taskName)+" ")])})),0)],1)],1),a("div",{staticClass:"tab-content"},[t._l(t.tabDataSelf,(function(e){return t._l(e.paramInfoMap,(function(i){return a("editor-input",{directives:[{name:"show",rawName:"v-show",value:t.currentType===e.taskName,expression:"currentType===item.taskName"}],staticStyle:{"margin-bottom":"15px"},attrs:{label:i.alias,required:!0,value:i.value},on:{change:t.change,"update:value":function(e){return t.$set(i,"value",e)}}})}))}))],2)])},gt=[],bt=a("b76a"),yt=a.n(bt),Ct={name:"Tab",props:{tabData:{required:!0,type:Array}},watch:{tabData:{handler:function(t,e){this.initData()},deep:!0,immediate:!0}},data:function(){return{drag:!1,currentType:"",tabDataSelf:[]}},methods:{initData:function(){this.tabDataSelf=lt(this.tabData),this.tabDataSelf.length>0&&this.getActiveTaskName()},getActiveTaskName:function(){for(var t=!1,e=0,a=this.tabDataSelf.length;e<a;e++){var i=this.tabDataSelf[e];if(i.taskName===this.currentType){t=!0,this.currentType=i.taskName;break}}t||(this.currentType=this.tabDataSelf[0].taskName)},change:function(){this.$emit("change",this.tabDataSelf)},changeBase:function(){},remove:function(){},handleTab:function(t){this.currentType=t.taskName}},computed:{dragOptions:function(){return{animation:200,group:"description",disabled:!1,ghostClass:"ghost"}}},components:{draggable:yt.a,EditorInput:ft}},wt=Ct,Dt=(a("51f3"),Object(m["a"])(wt,vt,gt,!1,null,"074f2c3a",null)),xt=Dt.exports,kt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"logger-wrap",staticStyle:{height:"300px",width:"600px"}},[a("DynamicScroller",{staticClass:"recycle-list-wrap",attrs:{items:t.datas,"min-item-size":54,"key-field":"index",id:"dynamicScroller"},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.item,s=e.index,n=e.active;return[a("DynamicScrollerItem",{attrs:{item:i,active:n,"size-dependencies":[i.text],"data-index":s}},[a("div",{staticClass:"log",class:t.color[i.type]},[t._v(">> "+t._s(i.text))])])]}}])})],1)},_t=[],Ft=0,St=500,Et={name:"Logger",components:{DynamicScroller:u["a"],DynamicScrollerItem:u["b"]},props:{loggerData:"",jobKey:""},data:function(){return{datas:[],itemKey:"jobKey",color:{0:"success",1:"info",2:"warn",3:"error"}}},watch:{loggerData:function(t){t.index=Ft++,this.datas.push(t),this.datas.length>St&&this.datas.splice(0,1),this.scrollToBottom()},jobKey:function(t){this.datas=[]}},mounted:function(){ot=document.getElementById("dynamicScroller")},methods:{scrollToBottom:function(){ot.scrollHeight>ot.clientHeight&&setTimeout((function(){ot.scrollTop=ot.scrollHeight}),0)}}},jt=Et,It=(a("e62a"),Object(m["a"])(jt,kt,_t,!1,null,"69393605",null)),Nt=It.exports,$t=a("117d"),Tt="jobDetails/updateJob",qt="jobDetails/addJob",At={name:"DispatchContent",mixins:[pt],data:function(){return{updateUrl:Tt,addUrl:qt,extendedConfig:{},selfForm:{},AllJob:[],jobList:[],currentJob:[],taskInfos:[],isFirstInit:!0,cronPopover:!1,visible:!1,handleType:mt}},props:{loggerData:null,state:mt["scan"]},watch:{form:{handler:function(t,e){t.isUpdate&&this.initData()},deep:!0},currentJob:{handler:function(t,e){this.isFirstInit?this.isFirstInit=!1:this.setTask(t,e)}}},created:function(){this.getTasks()},mounted:function(){this.isEdit=!1},methods:{changeTab:function(t){this.taskInfos=t,this.changeEditState()},initData:function(){this.isEdit=!1,this.isFirstInit=!0,this.taskInfos=[],this.selfForm=lt(this.form),this.selfForm.extendedConfig&&(this.extendedConfig=JSON.parse(this.selfForm.extendedConfig)),this.getTask()},changeCron:function(t){this.selfForm.cronExpression=t,this.changeEditState()},changeCronValue:function(){this.cronPopover=!0,this.changeEditState()},setTask:function(t,e){if(t.length>e.length)for(var a=this.getArrDif(t,e)[0],i=0,s=this.jobList.length;i<s;i++){var n=this.jobList[i];if(n.taskName+n.group===a){this.taskInfos.push(n);break}}else if(e.length>t.length)for(var l=this.getArrDif(e,t)[0],o=0,r=this.taskInfos.length;o<r;o++){var c=this.taskInfos[o];if(c.taskName+c.group===l){this.taskInfos.splice(o,1);break}}},getTask:function(){if(this.currentJob=[],this.selfForm.taskInfos){for(var t=0,e=this.selfForm.taskInfos.length;t<e;t++){var a=this.selfForm.taskInfos[t];this.currentJob.push(a.taskName+a.group)}this.taskInfos=lt(this.selfForm.taskInfos)}},setRequestData:function(){2===this.selfForm.transmissionMode&&(this.selfForm.extendedConfig=JSON.stringify(this.extendedConfig)),this.selfForm.taskInfos=lt(this.taskInfos)},validate:function(){return""===this.selfForm.jobName||""===this.selfForm.jobGroup||""===this.selfForm.description||""===this.selfForm.cronExpression||0===this.currentJob.length},validateCopyData:function(){return""===this.selfForm.targetPath},getTasks:function(){var t=this,e="jobDetails/getTasks";this.request.get(e).then((function(e){var a=e.data.data,i=[];for(var s in a)i.push({label:s,value:s,options:a[s]}),t.jobList=t.jobList.concat(a[s]);t.AllJob=i})).catch((function(t){console.log(t)}))},getArrDif:function(t,e){return t.filter((function(t){return-1===e.indexOf(t)}))}},components:{tab:xt,cron:$t["cron"],taskLogger:Nt}},Ot=At,Lt=(a("3ac0"),Object(m["a"])(Ot,G,Y,!1,null,"285a929e",null)),Ut=Lt.exports,Kt=(a("d3b7"),{data:function(){return{fileData:[],allFileData:[],currentViewData:{},handleType:mt,state:mt["scan"],showContent:!0,visibleDialog:!1,deleteFileData:{},active:""}},mounted:function(){},methods:{getFileList:function(){var t=this;return new Promise((function(e,a){t.request.get(t.listUrl).then((function(t){200===t.data.code&&e(t.data.data)})).catch((function(t){console.log(t)}))}))},create:function(){this.currentViewData={},this.state=mt["add"]},handleAdd:function(t){this.allFileData.push(t),this.state=mt["scan"],t.isUpdate=!0,this.currentViewData=t,this.active=this.currentViewData[this.itemKey]},handleUpdate:function(t){for(var e=0,a=this.allFileData.length;e<a;e++){var i=this.allFileData[e];if(i[this.itemKey]===t[this.itemKey]){this.allFileData.splice(e,1),this.allFileData.push(t);break}}},handleDel:function(t){this.visibleDialog=!0,this.deleteFileData=t},deleteFile:function(){var t=this;this.request.postJson(this.deleteUrl,this.deleteFileData).then((function(e){200===e.data.code&&(t.removeFile(t.deleteFileData),t.message("删除成功！")),t.visibleDialog=!1})).catch((function(e){t.message("删除失败！","error"),t.visibleDialog=!1}))},removeFile:function(t){for(var e=0,a=this.allFileData.length;e<a;e++){var i=this.allFileData[e];if(t[this.itemKey]===i[this.itemKey]){this.allFileData.splice(e,1),this.setCurrentViewData();break}}},handleClick:function(t){if(t[0]!==this.currentViewData[this.itemKey]||this.state!==this.handleType["scan"]){for(var e=0,a=this.fileData.length;e<a;e++){var i=this.fileData[e];if(i[this.itemKey]===t[0]){i.isUpdate=!0,this.currentViewData=i;break}}this.state=this.handleType["scan"],this.switchViewAnimate()}},setCurrentViewData:function(){this.fileData.length>0?(this.fileData[0].isUpdate=!0,this.currentViewData=this.fileData[0]):this.currentViewData={},this.active=this.currentViewData[this.itemKey]},switchViewAnimate:function(){var t=this;this.showContent=!1,setTimeout((function(){t.showContent=!0}),450)},message:function(t,e){this.$message({message:t||"成功了！",type:e||"success"})}}}),Jt=a("bd1a"),Vt={taskWebsocketUrl:"",baseUrl:"",websocketDebug:!0},Bt=Vt,Pt="jobDetails/getAllJob",zt="jobDetails/deleteJob",Mt={name:"TaskSchedule",mixins:[Kt],data:function(){return{listUrl:Pt,deleteUrl:zt,itemKey:"key",loggerData:null}},mounted:function(){var t=this;this.getFileList().then((function(e){e&&(t.fileData=e,t.allFileData=e,0===t.allFileData.length&&t.addFile(),t.setCurrentViewData())})),this.initWebSocket()},beforeDestroy:function(){this.disconnect()},methods:{searchFile:function(t){this.fileData=[];for(var e=0,a=this.allFileData.length;e<a;e++){var i=this.allFileData[e],s=i.alias.indexOf(t)>-1||i.jobName.indexOf(t)>-1;s&&this.fileData.push(i)}},addFile:function(){this.switchViewAnimate(),this.currentViewData=lt({isUpdate:!0}),this.state=this.handleType["add"]},handleCommand:function(t){this.currentViewData=lt({transmissionMode:t.value}),this.state=1},handleCopy:function(t){var e=lt(t);e.isUpdate=!0,e.jobName="",e.alias="",e.description="",this.currentViewData=e,this.state=this.handleType["copy"],this.switchViewAnimate()},initWebSocket:function(){var t=this;rt=new Jt["b"](Bt.taskWebsocketUrl,{debug:Bt.websocketDebug}),rt.connect({},(function(e){t.subscribeStatus(),t.subscribeLogger()}))},disconnect:function(){null!=rt&&rt.disconnect()},unsubscribeStatus:function(t){rt.unsubscribe(t)},subscribeStatus:function(){var t=this;rt.subscribe("/job/status",(function(e){for(var a=JSON.parse(e.body),i=0,s=t.fileData.length;i<s;i++){var n=t.fileData[i];if(n.key===a.key){n.isUpdate=!1,n.status=a.status,a.nextFireTime&&(n.nextFireTime=a.nextFireTime),t.$forceUpdate();break}}}))},subscribeLogger:function(){var t=this;rt.subscribe("/job/task",(function(e){var a=JSON.parse(e.body);t.currentViewData.key===a.jobKey&&(t.loggerData=a)}))}},components:{RecycleList:w,TaskContent:Ut,TaskItem:H,AddComp:S,ScrollGroup:T,ScrollItem:V}},Rt=Mt,Wt=(a("70a7"),Object(m["a"])(Rt,l,o,!1,null,"3695c990",null)),Ht=Wt.exports,Gt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"file-watch-wrap"},[a("div",{staticStyle:{width:"280px"}},[a("add-comp",{on:{handleAdd:t.addFile,handleInput:t.searchFile}}),a("div",{staticStyle:{height:"calc(100% - 60px)"}},[a("scroll-group",{attrs:{enableDelete:!0},on:{change:t.handleClick,delete:t.handleDel},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.fileData,(function(e,i){return a("scroll-item",{attrs:{itemKey:e.id,index:i,source:e}},[a("file-watch-item",{attrs:{data:e,index:i},on:{handleCopy:t.handleCopy}})],1)})),1)],1)],1),a("transition",{attrs:{name:"fade-transform",mode:"out-in"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showContent,expression:"showContent"}],staticClass:"content-view-wrap"},[a("file-watch-content",{attrs:{form:t.currentViewData,state:t.state},on:{handleAdd:t.handleAdd,handleUpdate:t.handleUpdate}})],1)]),a("el-dialog",{attrs:{title:"删除提示",visible:t.visibleDialog,width:"30%"},on:{"update:visible":function(e){t.visibleDialog=e}}},[a("span",[t._v("确定删除该任务吗？")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.visibleDialog=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.deleteFile}},[t._v("确 定")])],1)])],1)},Yt=[],Qt=(a("d81d"),a("b0c0"),a("1276"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box-content"},[a("el-popover",{attrs:{placement:"top",width:"160",trigger:"manual"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("p",[t._v("确定新增任务？")]),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.visible=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSuccess(e)}}},[t._v("确定")])],1)]),a("div",{staticClass:"state",class:[t.data.enabled?"access":"forbid"],on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.visible=!0}}},[t._v(t._s(t.index+1))]),a("div",{staticClass:"value"},[a("div",{staticClass:"title item"},[t._v(t._s(t.data.name))]),a("div",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("监控目录：")]),t._v(t._s(t.data.directoryName))]),a("div",t._l(t.data.eventList,(function(e){return a("span",{staticClass:"event-name",style:{background:e.bg}},[t._v(t._s(e.label))])})),0)])],1)}),Xt=[],Zt={name:"FileWatchItem",mixins:[z]},te=Zt,ee=(a("711d"),Object(m["a"])(te,Qt,Xt,!1,null,"d056159e",null)),ae=ee.exports,ie=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-view"},[a("div",{staticClass:"save-button"},[a("el-button",{staticStyle:{width:"100px"},attrs:{type:t.isEdit?"primary":"info",disabled:!t.isEdit,size:"small"},on:{click:t.save}},[t._v("保存 ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:0===t.state,expression:"state===0"}],staticClass:"update-remind"},[a("span",{staticClass:"job-name-title"},[t._v(t._s(t.selfForm.name))]),a("span",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],staticClass:"remind"},[t._v("注意：内容正在编辑，修改完成记得保存哟！")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:1===t.state,expression:"state===1"}],staticClass:"add-remind"},[a("span",{staticClass:"add-warn"},[t._v("注意：当前正在创建一个新的文件推送任务！")])])],1),a("div",{staticClass:"content-mid-wrap"},[a("div",{staticClass:"block"},[a("div",{staticClass:"title"},[t._v("基础信息")]),a("card",{attrs:{label:"监控基本信息"}},[a("editor-input",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"监控名称",required:!0,value:t.selfForm.name},on:{change:t.changeBase,"update:value":function(e){return t.$set(t.selfForm,"name",e)}}}),a("editor-input",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"文件路径",required:!0,value:t.selfForm.path},on:{"update:value":function(e){return t.$set(t.selfForm,"path",e)},change:t.changeBase}}),a("div",{staticClass:"item-block"},[a("span",{staticStyle:{"margin-right":"8px"}},[a("svg-icon",{staticClass:"required",attrs:{"icon-class":"require"}}),t._v("启用监控")],1),a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"#13ce66","inactive-color":"#dcdfe6"},on:{change:t.changeBase},model:{value:t.selfForm.enabled,callback:function(e){t.$set(t.selfForm,"enabled",e)},expression:"selfForm.enabled"}})],1),a("div",{staticClass:"item-block"},[a("span",{staticStyle:{"margin-right":"8px"}},[a("svg-icon",{staticClass:"required",attrs:{"icon-class":"require"}}),t._v("启用子文件夹监控")],1),a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"#13ce66","inactive-color":"#dcdfe6"},on:{change:t.changeBase},model:{value:t.selfForm.watchSubDirectories,callback:function(e){t.$set(t.selfForm,"watchSubDirectories",e)},expression:"selfForm.watchSubDirectories"}})],1),a("div",{staticClass:"item-block"},[a("span",{staticStyle:{"margin-right":"8px"}},[a("svg-icon",{staticClass:"required",attrs:{"icon-class":"require"}}),t._v("启用文件分发")],1),a("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-color":"#13ce66","inactive-color":"#dcdfe6"},on:{change:t.changeBase},model:{value:t.selfForm.mode,callback:function(e){t.$set(t.selfForm,"mode",e)},expression:"selfForm.mode"}})],1)],1)],1),1===t.selfForm.mode?a("div",{staticClass:"block"},[a("div",{staticClass:"title"},[t._v("分发配置")]),a("card",{attrs:{label:"分发配置"}},[a("div",[a("span",{staticClass:"labelName"},[a("svg-icon",{staticClass:"required",attrs:{"icon-class":"require"}}),t._v("分发类型：")],1),a("el-select",{staticStyle:{width:"200px"},attrs:{multiple:"","collapse-tags":"",placeholder:"请选择",size:"small"},on:{change:t.changeEspecial},model:{value:t.dispatchIds,callback:function(e){t.dispatchIds=e},expression:"dispatchIds"}},t._l(t.dispatchList,(function(t){return a("el-option",{key:t.type,attrs:{label:t.name,value:t.type}})})),1)],1),a("p",{staticClass:"labelName"},[a("svg-icon",{staticClass:"required",attrs:{"icon-class":"require"}}),t._v("文件类型：")],1),t._l(t.watcherDispatches,(function(e){return a("div",{staticStyle:{"margin-bottom":"5px","padding-left":"15px","box-sizing":"border-box","font-size":"12px"}},[a("span",[t._v(t._s(e.dispatchName)+"：")]),a("el-select",{staticStyle:{width:"220px"},attrs:{multiple:"","collapse-tags":"",placeholder:"请选择",size:"mini"},on:{change:function(a){return t.changeFile(a,e.dispatchType)}},model:{value:e.dataConfigIdsArr,callback:function(a){t.$set(e,"dataConfigIdsArr",a)},expression:"fileType.dataConfigIdsArr"}},t._l(t.fileList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.alias,value:t.id}})})),1)],1)}))],2)],1):a("div",{staticClass:"block"},[a("div",{staticClass:"title"},[t._v("过滤器")]),a("card",{attrs:{label:"文件过滤配置"}},[a("editor-input",{staticStyle:{"margin-bottom":"15px"},attrs:{label:"文件类型过滤",required:!1,value:t.selfForm.fileFilter},on:{change:t.changeBase,"update:value":function(e){return t.$set(t.selfForm,"fileFilter",e)}}}),a("editor-input",{staticStyle:{"margin-bottom":"15px"},attrs:{label:"子文件类型过滤",required:!1,value:t.selfForm.watchDirFilter},on:{change:t.changeBase,"update:value":function(e){return t.$set(t.selfForm,"watchDirFilter",e)}}})],1)],1),a("div",{staticClass:"block"},[a("div",{staticClass:"title"},[t._v("监控配置")]),a("card",{staticStyle:{width:"330px"},attrs:{label:"事件配置"}},[a("div",{staticClass:"item-block"},[a("p",{staticClass:"labelName"},[a("svg-icon",{staticClass:"required",attrs:{"icon-class":"require"}}),t._v("exceptionHandler的实现类")],1),a("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:t.changeBase},model:{value:t.selfForm.exceptionHandlerClass,callback:function(e){t.$set(t.selfForm,"exceptionHandlerClass",e)},expression:"selfForm.exceptionHandlerClass"}},t._l(t.exceptionHandlerList,(function(t){return a("el-option",{key:t.name,attrs:{label:t.name,value:t.className}})})),1)],1),a("div",{staticClass:"item-block"},[a("p",{staticClass:"labelName"},[a("svg-icon",{staticClass:"required",attrs:{"icon-class":"require"}}),t._v("回调Listener的实现类")],1),a("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:t.changeBase},model:{value:t.selfForm.listenerClass,callback:function(e){t.$set(t.selfForm,"listenerClass",e)},expression:"selfForm.listenerClass"}},t._l(t.dispatchListenList,(function(e){return 1===t.selfForm.mode?a("el-option",{key:e.name,attrs:{label:e.name,value:e.className}}):t._l(t.filterListenList,(function(t){return a("el-option",{key:t.name,attrs:{label:t.name,value:t.className}})}))})),1)],1),a("div",{staticClass:"item-block"},[a("p",{staticClass:"labelName"},[a("svg-icon",{staticClass:"not-required",attrs:{"icon-class":"require"}}),t._v("开始回调类")],1),a("el-select",{attrs:{placeholder:"请选择",size:"small"},on:{change:t.changeBase},model:{value:t.selfForm.startListenerClass,callback:function(e){t.$set(t.selfForm,"startListenerClass",e)},expression:"selfForm.startListenerClass"}},t._l(t.startListenerList,(function(t){return a("el-option",{key:t.name,attrs:{label:t.name,value:t.className}})})),1)],1)])],1),a("div",{staticClass:"block"},[a("div",{staticClass:"title"},[t._v("监控相关事件")]),a("card",{attrs:{label:"事件编辑"}},[a("p",{staticClass:"labelName"},[a("svg-icon",{staticClass:"required",attrs:{"icon-class":"require"}}),t._v("事件类型：")],1),a("el-select",{attrs:{multiple:"",placeholder:"请选择",size:"small"},on:{change:t.changeBase},model:{value:t.eventIds,callback:function(e){t.eventIds=e},expression:"eventIds"}},t._l(t.eventList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1)])])},se=[],ne=(a("a15b"),[{value:1,label:"创建",bg:"linear-gradient(0deg, rgb(5 156 108), rgb(8 199 129))"},{value:2,label:"删除",bg:"linear-gradient(0deg, rgb(167 38 8), rgb(214 47 9))"},{value:3,label:"修改",bg:"linear-gradient(0deg,  rgb(181 128 6),rgb(212 179 7))"},{value:4,label:"重命名",bg:"linear-gradient(0deg,rgb(11,148,245),rgb(8,185,226))"}]),le={name:"FileWatchContent",mixins:[pt],data:function(){return{exceptionHandlerList:[],dispatchList:[],dispatchListenList:[],filterListenList:[],startListenerList:[],fileList:[],eventList:ne,isEditBase:!1,isEditEspecial:!1,dispatchIds:[],eventIds:[],selfForm:{},watcherDispatches:[],isFirstInit:!0}},watch:{dispatchIds:{handler:function(t,e){this.isFirstInit?this.isFirstInit=!1:this.setFiles(t,e)},deep:!0},form:{handler:function(t,e){this.initFirstData(),this.getDispatchIds(),this.getEventIds()},deep:!0}},created:function(){this.setData()},methods:{initEditData:function(){this.isEditBase=!1,this.isEditEspecial=!1,this.isEdit=!1},initFirstData:function(){this.initEditData(),this.isFirstInit=!0,this.watcherDispatches=[],this.selfForm=lt(this.form)},validateBase:function(){var t=""===this.selfForm.name||""===this.selfForm.path||""===this.selfForm.exceptionHandlerClass||""===this.selfForm.listenerClass||""===this.selfForm.event;return t},validateEspecial:function(){return this.dispatchIds===[]||this.watcherDispatches===[]},save:function(){this.isEditBase&&this.saveBase(),this.isEditEspecial&&0===this.state&&this.saveEspecial()},saveBase:function(){var t,e=this;(this.formatRequestData(),this.validateBase())?this.message("信息不能留空，请继续填写！","warning"):(0===this.state?t="watchConfig/updateConfig":(t="watchConfig/addConfig",this.selfForm.watcherDispatches=this.watcherDispatches),this.request.postJson(t,this.selfForm).then((function(t){200===t.data.code&&(e.message("保存成功！"),1===e.state?e.$emit("handleAdd",t.data.data):e.$emit("handleUpdate",t.data.data),e.initEditData())})).catch((function(t){e.initEditData(),e.message("保存失败！","error")})))},saveEspecial:function(){var t=this;if(this.validateEspecial())this.message("信息不能留空，请继续填写！","warning");else{var e="watchConfig/batchSaveWatcherDispatch";this.request.postJson(e,this.watcherDispatches).then((function(e){200===e.data.code&&(t.message("保存成功！"),1===t.state?t.$emit("handleAdd",e.data.data):t.$emit("handleUpdate",e.data.data),t.initEditData())})).catch((function(e){t.initEditData(),t.message("保存失败！","error")}))}},getEventIds:function(){this.eventIds=[],this.selfForm.event&&this.selfForm.event.length>0&&(this.eventIds=this.selfForm.event.split(",").map(Number))},getDispatchIds:function(){this.dispatchIds=[];var t=this.selfForm.watcherDispatches;if(t&&t.length>0){this.watcherDispatches=lt(t);for(var e=0,a=this.watcherDispatches.length;e<a;e++){var i=this.watcherDispatches[e];this.dispatchIds.push(i.dispatchType),i.dataConfigIdsArr=i.dataConfigIds.split(",").map(Number)}}},formatRequestData:function(){this.setEvent()},setEvent:function(){this.selfForm.event=this.eventIds.join(",")},setFiles:function(t,e){if(t.length>e.length)for(var a=this.getArrDif(t,e)[0],i=0,s=this.dispatchList.length;i<s;i++){var n=this.dispatchList[i];if(n.type===a){this.watcherDispatches.push({dataConfigIds:"",dataConfigIdsArr:[],dispatchName:n.name,dispatchType:n.type,watcherConfigId:this.selfForm.id?this.selfForm.id:""});break}}else if(e.length>t.length)for(var l=this.getArrDif(e,t)[0],o=0,r=this.watcherDispatches.length;o<r;o++){var c=this.watcherDispatches[o];if(c.dispatchType===l){this.watcherDispatches.splice(o,1);break}}},changeFile:function(t,e){this.changeEspecial();for(var a=0,i=this.watcherDispatches.length;a<i;a++){var s=this.watcherDispatches[a];if(s.dispatchType===e){s.dataConfigIds=t.join(","),s.dataConfigIdsArr=t,this.$forceUpdate();break}}},changeBase:function(){this.changeEditState(),this.isEditBase=!0},changeEspecial:function(){this.changeEditState(),this.isEditEspecial=!0},setData:function(){var t=this;this.getData("watchConfig/getExceptionHandlerList").then((function(e){t.exceptionHandlerList=e})),this.getData("watchConfig/getDispatchList").then((function(e){for(var a in e)t.dispatchList.push(e[a])})),this.getData("watchConfig/getListenerList").then((function(e){for(var a=0,i=e.length;a<i;a++){var s=e[a];"DispatcherListener"===s.name?t.dispatchListenList.push(s):t.filterListenList.push(s)}})),this.getData("watchConfig/getStartListenerList").then((function(e){t.startListenerList=e})),this.getData("watchConfig/listDataConfig").then((function(e){t.fileList=e}))},getData:function(t){var e=this;return new Promise((function(a,i){e.request.get(t).then((function(t){200===t.data.code&&a(t.data.data)})).catch((function(t){console.log(t),i(t)}))}))},getArrDif:function(t,e){return t.filter((function(t){return-1===e.indexOf(t)}))}}},oe=le,re=(a("f019"),Object(m["a"])(oe,ie,se,!1,null,"5962ffc8",null)),ce=re.exports,ue=[{value:1,label:"创建",bg:"linear-gradient(0deg, rgb(5 156 108), rgb(8 199 129))"},{value:2,label:"删除",bg:"linear-gradient(0deg, rgb(167 38 8), rgb(214 47 9))"},{value:3,label:"修改",bg:"linear-gradient(0deg,  rgb(181 128 6),rgb(212 179 7))"},{value:4,label:"重命名",bg:"linear-gradient(0deg,rgb(11,148,245),rgb(8,185,226))"}],de="watchConfig/listConfig",he="watchConfig/deleteConfig",fe={name:"FileWatch",mixins:[Kt],data:function(){return{listUrl:de,deleteUrl:he,itemKey:"id",index:1}},mounted:function(){var t=this;this.getFileList().then((function(e){t.getEvents(e),t.fileData=e,t.allFileData=e,0===t.allFileData.length&&t.addFile(),t.setCurrentViewData()}))},methods:{searchFile:function(t){this.fileData=[];for(var e=0,a=this.allFileData.length;e<a;e++){var i=this.allFileData[e],s=i.name.indexOf(t)>-1;s&&this.fileData.push(i)}},addFile:function(){this.switchViewAnimate(),this.currentViewData=lt({isUpdate:!0}),this.state=1},handleAdd:function(t){this.fileData.push(t),this.getEvents(this.fileData),this.state=0},handleUpdate:function(t){for(var e=0,a=this.fileData.length;e<a;e++){var i=this.fileData[e];if(i[this.itemKey]===t[this.itemKey]){this.fileData.splice(e,1),this.fileData.push(t),this.getEvents(this.fileData);break}}},getEvents:function(t){for(var e=0,a=t.length;e<a;e++){var i=t[e],s=i.event.split(",").map(Number);i.eventList=[];for(var n=0,l=s.length;n<l;n++)for(var o=s[n],r=0,c=ue.length;r<c;r++){var u=ue[r];if(o==u.value){i.eventList.push(u);break}}}},handleCopy:function(t){var e=lt(t);e.id="",e.name="",e.path="",this.currentViewData=e,this.state=1,this.switchViewAnimate()}},components:{RecycleList:w,FileWatchContent:ce,FileWatchItem:ae,AddComp:S,ScrollItem:V,ScrollGroup:T}},pe=fe,me=(a("ed99"),Object(m["a"])(pe,Gt,Yt,!1,null,"9ed836be",null)),ve=me.exports,ge=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"file-watch-wrap"},[a("div",{staticStyle:{width:"280px"}},[a("add-comp",{on:{handleAdd:t.addFile,handleInput:t.searchFile}}),a("div",{staticStyle:{height:"calc(100% - 60px)"}},[a("scroll-group",{attrs:{enableDelete:!0},on:{change:t.handleClick,delete:t.handleDel},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.fileData,(function(e,i){return a("scroll-item",{attrs:{itemKey:e.id,index:i,source:e}},[a("file-config-item",{attrs:{data:e,index:i},on:{handleCopy:t.handleCopy}})],1)})),1)],1)],1),a("transition",{attrs:{name:"fade-transform",mode:"out-in"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.showContent,expression:"showContent"}],staticClass:"content-view-wrap"},[a("file-config-content",{attrs:{form:t.currentViewData,state:t.state},on:{handleAdd:t.handleAdd,handleUpdate:t.handleUpdate}})],1)]),a("el-dialog",{attrs:{title:"删除提示",visible:t.visibleDialog,width:"30%"},on:{"update:visible":function(e){t.visibleDialog=e}}},[a("span",[t._v("确定删除该任务吗？")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.visibleDialog=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.deleteFile}},[t._v("确 定")])],1)])],1)},be=[],ye=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"box-content"},[a("el-popover",{attrs:{placement:"top",width:"160",trigger:"manual"},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("p",[t._v("确定新增任务？")]),a("div",{staticStyle:{"text-align":"right",margin:"0"}},[a("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.visible=!1}}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.handleSuccess(e)}}},[t._v("确定")])],1)]),a("div",{staticClass:"state",class:[t.data.enabled?"access":"forbid"],on:{click:function(e){e.stopPropagation(),e.preventDefault(),t.visible=!0}}},[t._v(t._s(t.index+1))]),a("div",{staticClass:"value"},[a("div",{staticClass:"title item"},[t._v(t._s(t.data.alias)+"（"+t._s(t.data.name)+"）")]),a("div",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("文件规则：")]),t._v(t._s(t.data.fileTip))]),a("div",{staticClass:"item"},[a("span",{staticClass:"label"},[t._v("路径规则：")]),t._v(t._s(t.data.pathTip))])])],1)},Ce=[],we={name:"FileConfigItem",mixins:[z]},De=we,xe=(a("2ff1"),Object(m["a"])(De,ye,Ce,!1,null,"34bae2ee",null)),ke=xe.exports,_e=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-view"},[a("div",{staticClass:"save-button"},[a("el-button",{staticStyle:{width:"100px"},attrs:{type:t.isEdit?"primary":"info",disabled:!t.isEdit,size:"small"},on:{click:t.save}},[t._v("保存 ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:0===t.state,expression:"state===0"}],staticClass:"update-remind"},[a("span",{staticClass:"job-name-title"},[t._v(t._s(t.form.alias)+"("+t._s(t.form.name)+")")]),a("span",{directives:[{name:"show",rawName:"v-show",value:t.isEdit,expression:"isEdit"}],staticClass:"remind"},[t._v("注意：内容正在编辑，修改完成记得保存哟！")])]),a("div",{directives:[{name:"show",rawName:"v-show",value:1===t.state,expression:"state===1"}],staticClass:"add-remind"},[a("span",{staticClass:"add-warn"},[t._v("注意：当前正在创建一个新的文件推送任务！")])])],1),a("div",{staticClass:"content-mid-wrap"},[a("div",{staticClass:"block"},[a("div",{staticClass:"title"},[t._v("基础信息")]),a("card",{attrs:{label:"文件配置基本信息"}},[a("editor-input",{staticStyle:{"margin-bottom":"15px"},attrs:{label:"名称(英文)",required:!0,value:t.form.name},on:{change:t.changeEditState,"update:value":function(e){return t.$set(t.form,"name",e)}}}),a("editor-input",{staticStyle:{"margin-bottom":"15px"},attrs:{label:"别名(中文)",required:!0,value:t.form.alias},on:{change:t.changeEditState,"update:value":function(e){return t.$set(t.form,"alias",e)}}}),a("editor-input",{staticStyle:{"margin-bottom":"15px"},attrs:{label:"文件路径",required:!0,value:t.form.extend},on:{change:t.changeEditState,"update:value":function(e){return t.$set(t.form,"extend",e)}}}),a("editor-input",{staticStyle:{"margin-bottom":"15px"},attrs:{label:"文件匹配规则",required:!0,value:t.form.fileRegex},on:{change:t.changeEditState,"update:value":function(e){return t.$set(t.form,"fileRegex",e)}}}),a("editor-input",{staticStyle:{"margin-bottom":"15px"},attrs:{label:"路径匹配规则",required:!1,value:t.form.pathRegex},on:{change:t.changeEditState,"update:value":function(e){return t.$set(t.form,"pathRegex",e)}}})],1)],1)])])},Fe=[],Se="watchConfig/updateDataConfig",Ee="watchConfig/addDataConfig",je={name:"FileConfigContent",mixins:[pt],data:function(){return{updateUrl:Se,addUrl:Ee}},watch:{form:{handler:function(t,e){this.initData()},deep:!0}},methods:{initData:function(){this.selfForm=lt(this.form),this.isEdit=!1},validate:function(){return""===this.form.name||""===this.form.alias||""===this.form.extend||""===this.form.fileRegex},changeEditState:function(){this.isEdit=!0}}},Ie=je,Ne=(a("52ed"),Object(m["a"])(Ie,_e,Fe,!1,null,"0b5396ee",null)),$e=Ne.exports,Te="watchConfig/listDataConfig",qe="watchConfig/deleteDataConfig",Ae={name:"FileConfig",mixins:[Kt],data:function(){return{listUrl:Te,deleteUrl:qe,itemKey:"id",showContent:!0}},mounted:function(){var t=this;this.getFileList().then((function(e){t.fileData=e,t.allFileData=e,0===t.allFileData.length&&t.addFile(),t.setCurrentViewData()}))},methods:{searchFile:function(t){this.fileData=[];for(var e=0,a=this.allFileData.length;e<a;e++){var i=this.allFileData[e],s=i.alias.indexOf(t)>-1||i.name.indexOf(t)>-1;s&&this.fileData.push(i)}},addFile:function(){this.switchViewAnimate(),this.currentViewData=lt({isUpdate:!0}),this.state=1},handleCopy:function(t){var e=lt(t);e.name="",this.currentViewData=e,this.state=1,this.switchViewAnimate()}},components:{FileConfigContent:$e,FileConfigItem:ke,AddComp:S,ScrollItem:V,ScrollGroup:T}},Oe=Ae,Le=(a("5db9"),Object(m["a"])(Oe,ge,be,!1,null,"7f0be678",null)),Ue=Le.exports,Ke={name:"App",data:function(){return{user:[]}},mounted:function(){this.getData()},methods:{getData:function(){for(var t=0;t<50;t++){var e={name:"张三".concat(t),age:t,id:t};this.user.push(e)}}},components:{}},Je=Ke,Ve=(a("5c0b"),Object(m["a"])(Je,s,n,!1,null,null,null)),Be=Ve.exports,Pe=a("5c96"),ze=a.n(Pe),Me=(a("0fae"),a("b20f"),a("fb92"),null),Re=window.location.href;Re=Re.substring(0,Re.indexOf("/",9)+1);var We=function(){return null==Me&&(Me=He),Me},He={baseUrl:Re,baseImgUrl:"http://192.168.1.23:8030/"};Ue.install=function(t){t.component(Ue.name,Ue)};var Ge=Ue;ve.install=function(t){t.component(ve.name,ve)};var Ye=ve,Qe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("svg",{class:t.svgClass,attrs:{"aria-hidden":"true"}},[a("use",{attrs:{"xlink:href":t.iconName}})])},Xe=[],Ze={name:"SvgIcon",props:{iconClass:{type:String,required:!0},className:{type:String,default:""}},computed:{iconName:function(){return"#icon-".concat(this.iconClass)},svgClass:function(){return this.className?"svg-icon "+this.className:"svg-icon"}}},ta=Ze,ea=(a("2f21"),Object(m["a"])(ta,Qe,Xe,!1,null,"2f0f1ae2",null)),aa=ea.exports;a("54f4");Ht.install=function(t){t.component("svg-icon",aa),t.component(Ht.name,Ht)};var ia=Ht,sa=[Ge,Ye,ia],na=function(t){sa.forEach((function(e){t.component(e.name,e)}))};"undefined"!==typeof window&&window.Vue&&na(window.Vue);var la={install:na,FileConfig:Ge,FileWatch:Ye,TaskSchedule:ia,config:Bt};Bt.taskWebsocketUrl=We().baseUrl+"websocket";var oa=new Jt["a"](We().baseUrl);i["default"].prototype.request=oa,la.install(i["default"]),i["default"].component("svg-icon",aa),i["default"].use(ze.a),i["default"].config.productionTip=!1,new i["default"]({render:function(t){return t(Be)}}).$mount("#app")},"5c0b":function(t,e,a){"use strict";a("9c0c")},"5db9":function(t,e,a){"use strict";a("3b8b")},"607a":function(t,e,a){},6337:function(t,e,a){},"6cd4":function(t,e,a){"use strict";a("0226")},"6d78":function(t,e,a){},"6e98":function(t,e,a){"use strict";a("9df6")},"70a7":function(t,e,a){"use strict";a("7b21")},"711d":function(t,e,a){"use strict";a("93e3")},"73de":function(t,e,a){},"73f3":function(t,e,a){},"760f":function(t,e,a){t.exports=a.p+"img/eye.a18f1b79.svg"},"79a0":function(t,e,a){t.exports=a.p+"img/content.7833de51.svg"},"79af":function(t,e,a){t.exports=a.p+"img/require.6aade68a.svg"},"7b21":function(t,e,a){},"82f0":function(t,e,a){},8948:function(t,e,a){t.exports=a.p+"img/check.d5ab38a3.svg"},"8c1b":function(t,e,a){},"8d9c":function(t,e,a){},"93e3":function(t,e,a){},"9c0c":function(t,e,a){},"9d41":function(t,e,a){t.exports=a.p+"img/documentation.7d408b8a.svg"},"9df6":function(t,e,a){},"9f45":function(t,e,a){},a82a:function(t,e,a){var i={"./404.svg":"b15c","./cellphone.svg":"cdb6","./check.svg":"8948","./content.svg":"79a0","./documentation.svg":"9d41","./email.svg":"ffd0","./eye.svg":"760f","./password.svg":"477f","./require.svg":"79af","./search.svg":"faca","./time.svg":"236b","./user.svg":"d8e5"};function s(t){var e=n(t);return a(e)}function n(t){if(!a.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}s.keys=function(){return Object.keys(i)},s.resolve=n,t.exports=s,s.id="a82a"},a854:function(t,e,a){},b12d:function(t,e,a){"use strict";a("a854")},b15c:function(t,e,a){t.exports=a.p+"img/404.ba00b810.svg"},b20f:function(t,e,a){},c02f:function(t,e,a){},c6fa:function(t,e,a){"use strict";a("14dc")},cdb6:function(t,e,a){t.exports=a.p+"img/cellphone.b697717c.svg"},d8e5:function(t,e,a){t.exports=a.p+"img/user.60b2937e.svg"},dbb2b:function(t,e,a){},e603:function(t,e,a){},e62a:function(t,e,a){"use strict";a("8d9c")},e7ad:function(t,e,a){},ed99:function(t,e,a){"use strict";a("73de")},f019:function(t,e,a){"use strict";a("dbb2b")},faca:function(t,e,a){t.exports=a.p+"img/search.faba9c0f.svg"},fb92:function(t,e,a){a("4d63"),a("ac1f"),a("25f0"),a("5319"),Date.prototype.format=function(t){var e=t||"yyyy-MM-dd hh:mm:ss",a={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};for(var i in/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))),a)new RegExp("("+i+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?a[i]:("00"+a[i]).substr((""+a[i]).length)));return e}},ffd0:function(t,e,a){t.exports=a.p+"img/email.ab66061b.svg"}});
//# sourceMappingURL=app.db1c2b0d.js.map